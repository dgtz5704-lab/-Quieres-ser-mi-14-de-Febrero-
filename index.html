<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Minecraft Valentine わ</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

<style>
/* =========================================
   RESET & FONDO ANIMADO
   ========================================= */
* { box-sizing: border-box; }

body {
    margin: 0;
    height: 100vh;
    overflow: hidden;
    font-family: 'Press Start 2P', cursive;
    /* Cielo Minecraft */
    background-color: #79a6ff; 
    display: flex;
    align-items: center;
    justify-content: center;
    user-select: none;
}

/* Nubes en movimiento (CSS puro) */
.clouds {
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    z-index: 0;
    background: transparent;
    pointer-events: none;
}

.cloud {
    position: absolute;
    background: rgba(255, 255, 255, 0.8);
    width: 100px; height: 30px;
    animation: moveClouds linear infinite;
    opacity: 0.9;
}
.cloud::after, .cloud::before {
    content: ''; position: absolute; background: inherit;
}
.cloud::after { width: 40px; height: 40px; top: -20px; left: 15px; }
.cloud::before { width: 30px; height: 30px; top: -15px; left: 50px; }

@keyframes moveClouds {
    from { transform: translateX(-150px); }
    to { transform: translateX(110vw); }
}

/* =========================================
   ESTILO GUI (INTERFAZ MINECRAFT)
   ========================================= */
.mc-panel {
    position: relative;
    z-index: 10;
    background-color: #c6c6c6; /* Gris cl谩sico */
    border-top: 4px solid #fff;
    border-left: 4px solid #fff;
    border-right: 4px solid #555;
    border-bottom: 4px solid #555;
    padding: 20px;
    width: 90%;
    max-width: 400px;
    text-align: center;
    box-shadow: 10px 10px 0 rgba(0,0,0,0.5);
    display: flex;
    flex-direction: column;
    align-items: center;
}

/* T铆tulos */
h1 {
    font-size: 16px;
    color: #3f3f3f;
    margin-bottom: 20px;
    line-height: 1.5;
    text-shadow: 2px 2px 0px #fff;
}

/* Inputs estilo chat */
.mc-input {
    width: 100%;
    background: #000;
    border: 2px solid #a0a0a0;
    color: #fff;
    font-family: 'Press Start 2P', cursive;
    font-size: 12px;
    padding: 10px;
    margin-bottom: 15px;
    outline: none;
}
.mc-input::placeholder { color: #aaa; }

/* Texto normal */
p {
    font-size: 10px;
    color: #333;
    line-height: 1.6;
    margin-bottom: 15px;
}

/* =========================================
   BOTONES MINECRAFT
   ========================================= */
.mc-btn {
    font-family: 'Press Start 2P', cursive;
    font-size: 14px;
    color: #fff;
    background: #777;
    border: none;
    padding: 12px 10px;
    width: 100%;
    cursor: pointer;
    text-shadow: 2px 2px 0 #000;
    position: relative;
    
    /* Efecto 3D CSS */
    box-shadow: inset -4px -4px 0px #333, inset 4px 4px 0px #fff, 4px 4px 0px #000;
    margin-top: 10px;
}

.mc-btn:active {
    background: #666;
    box-shadow: inset 4px 4px 0px #333, inset -4px -4px 0px #fff;
    transform: translateY(4px);
}

.btn-green { background: #4ba64a; } /* Bot贸n aceptar */
.btn-red { background: #df4545; }   /* Bot贸n cancelar/no */

/* Contenedor de botones S铆/No */
.actions {
    display: flex;
    gap: 20px;
    width: 100%;
    justify-content: center;
    margin-top: 20px;
    min-height: 60px; /* Espacio para que no colapse */
}

.btn-floating {
    width: auto;
    padding: 12px 20px;
    transition: left 0.1s, top 0.1s; 
}

/* Link generado */
.link-box {
    margin-top: 15px;
    padding: 10px;
    background: #e0e0e0;
    border: 2px solid #555;
    font-family: monospace;
    font-size: 10px;
    word-break: break-all;
    user-select: text;
    display: none;
}

/* Coraz贸n flotante */
.pixel-heart {
    image-rendering: pixelated;
    font-size: 40px;
    animation: heartbeat 1.5s infinite;
    margin-bottom: 10px;
    color: #ff3333;
    text-shadow: 4px 4px 0 #000;
}

@keyframes heartbeat {
    0% { transform: scale(1); }
    15% { transform: scale(1.3); }
    30% { transform: scale(1); }
    45% { transform: scale(1.15); }
    60% { transform: scale(1); }
}

</style>
</head>
<body>

<div class="clouds">
    <div class="cloud" style="top: 10%; animation-duration: 25s;"></div>
    <div class="cloud" style="top: 30%; animation-duration: 35s; opacity: 0.6;"></div>
    <div class="cloud" style="top: 60%; animation-duration: 20s;"></div>
</div>

<div id="creator-panel" class="mc-panel">
    <div class="pixel-heart"></div>
    <h1>Craftea tu<br>San Valent铆n</h1>
    
    <p style="text-align:left; width:100%;">De parte de:</p>
    <input type="text" id="fromInput" class="mc-input" placeholder="Tu nick...">
    
    <p style="text-align:left; width:100%;">Para:</p>
    <input type="text" id="toInput" class="mc-input" placeholder="Su nick...">

    <button class="mc-btn btn-green" onclick="generateUrl()">GENERAR MUNDO</button>
    
    <div id="result-box" class="link-box"></div>
    <button id="copy-btn" class="mc-btn" style="display:none;" onclick="copyLink()">COPIAR LINK</button>
</div>

<div id="card-panel" class="mc-panel" style="display:none;">
    <div class="pixel-heart">わ</div>
    <h1 id="card-msg"></h1>
    <p id="card-sub" style="font-size:12px; color:#555;"></p>

    <div class="actions">
        <button id="btn-si" class="mc-btn btn-green btn-floating">S</button>
        <button id="btn-no" class="mc-btn btn-red btn-floating">NO</button>
    </div>
</div>

<div id="success-panel" class="mc-panel" style="display:none; border-color: gold;">
    <div style="font-size:50px;">佛</div>
    <h1 style="color: #4ba64a;">隆Logro Desbloqueado!</h1>
    <p>Ahora tienen una relaci贸n de diamante.</p>
    <p style="font-size: 8px;">(Captura esto y m谩ndaselo)</p>
</div>

<script>
// ==========================================
// SISTEMA DE AUDIO (Web Audio API - Sin archivos)
// ==========================================
const AudioContext = window.AudioContext || window.webkitAudioContext;
const audioCtx = new AudioContext();

function playSound(type) {
    if (audioCtx.state === 'suspended') audioCtx.resume();
    
    const osc = audioCtx.createOscillator();
    const gainNode = audioCtx.createGain();
    
    osc.connect(gainNode);
    gainNode.connect(audioCtx.destination);

    if (type === 'click') {
        // Sonido "Blip" seco tipo men煤
        osc.type = 'square';
        osc.frequency.setValueAtTime(150, audioCtx.currentTime);
        osc.frequency.exponentialRampToValueAtTime(600, audioCtx.currentTime + 0.1);
        gainNode.gain.setValueAtTime(0.1, audioCtx.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
        osc.start();
        osc.stop(audioCtx.currentTime + 0.1);
    } 
    else if (type === 'hover') {
        // Sonido suave al intentar tocar el NO
        osc.type = 'sine';
        osc.frequency.setValueAtTime(200, audioCtx.currentTime);
        gainNode.gain.setValueAtTime(0.05, audioCtx.currentTime);
        gainNode.gain.linearRampToValueAtTime(0, audioCtx.currentTime + 0.05);
        osc.start();
        osc.stop(audioCtx.currentTime + 0.05);
    }
    else if (type === 'success') {
        // Sonido "Level Up" (Arpegio r谩pido)
        const now = audioCtx.currentTime;
        
        // Nota 1
        const osc1 = audioCtx.createOscillator();
        const g1 = audioCtx.createGain();
        osc1.type = 'square';
        osc1.frequency.value = 523.25; // C5
        osc1.connect(g1); g1.connect(audioCtx.destination);
        g1.gain.value = 0.1;
        osc1.start(now); osc1.stop(now + 0.1);

        // Nota 2
        const osc2 = audioCtx.createOscillator();
        const g2 = audioCtx.createGain();
        osc2.type = 'square';
        osc2.frequency.value = 659.25; // E5
        osc2.connect(g2); g2.connect(audioCtx.destination);
        g2.gain.value = 0.1;
        osc2.start(now + 0.1); osc2.stop(now + 0.2);

        // Nota 3 (Alta)
        const osc3 = audioCtx.createOscillator();
        const g3 = audioCtx.createGain();
        osc3.type = 'square';
        osc3.frequency.value = 1046.50; // C6
        osc3.connect(g3); g3.connect(audioCtx.destination);
        g3.gain.value = 0.1; g3.gain.linearRampToValueAtTime(0, now + 0.6);
        osc3.start(now + 0.2); osc3.stop(now + 0.6);
    }
}

// Agregar sonido a todos los botones
document.querySelectorAll('button').forEach(b => {
    b.addEventListener('click', () => playSound('click'));
});

// ==========================================
// LGICA DE LA TARJETA
// ==========================================
const params = new URLSearchParams(window.location.search);

// 1. MODO VISUALIZAR
if (params.has('to')) {
    document.getElementById('creator-panel').style.display = 'none';
    document.getElementById('card-panel').style.display = 'flex';
    
    const toName = params.get('to');
    const fromName = params.get('from');
    
    document.getElementById('card-msg').innerHTML = `隆Hola ${toName}!<br><br>驴Quieres ser mi Player 2?`;
    document.getElementById('card-sub').innerText = `${fromName} te invita a su servidor.`;

    // L贸gica Bot贸n NO (Escurridizo)
    const btnNo = document.getElementById('btn-no');
    
    const moveBtn = (e) => {
        // Evitar click real
        if(e) e.preventDefault();
        
        playSound('hover');

        // L铆mites de la pantalla (restamos tama帽o del bot贸n para que no se salga)
        const maxX = window.innerWidth - btnNo.offsetWidth - 20;
        const maxY = window.innerHeight - btnNo.offsetHeight - 20;
        
        const randomX = Math.max(10, Math.random() * maxX);
        const randomY = Math.max(10, Math.random() * maxY);
        
        // Convertir a posici贸n fija para que flote libremente
        btnNo.style.position = 'fixed';
        btnNo.style.left = randomX + 'px';
        btnNo.style.top = randomY + 'px';
        btnNo.style.zIndex = '100'; // Asegurar que quede encima de todo
    };

    // Eventos para PC y Celular
    btnNo.addEventListener('mouseenter', moveBtn);
    btnNo.addEventListener('touchstart', moveBtn);
    btnNo.addEventListener('click', moveBtn);

    // L贸gica Bot贸n S
    document.getElementById('btn-si').addEventListener('click', () => {
        playSound('success');
        document.getElementById('card-panel').style.display = 'none';
        document.getElementById('success-panel').style.display = 'flex';
        createConfetti();
    });
} 

// 2. MODO CREADOR (GENERAR LINK)
function generateUrl() {
    const from = document.getElementById('fromInput').value || 'Steve';
    const to = document.getElementById('toInput').value || 'Alex';
    
    const url = `${window.location.origin}${window.location.pathname}?to=${encodeURIComponent(to)}&from=${encodeURIComponent(from)}`;
    
    const resultBox = document.getElementById('result-box');
    resultBox.innerText = url;
    resultBox.style.display = 'block';
    document.getElementById('copy-btn').style.display = 'block';
}

function copyLink() {
    const text = document.getElementById('result-box').innerText;
    navigator.clipboard.writeText(text).then(() => {
        alert("隆Link copiado al portapapeles! ");
    });
}

// 3. EFECTO CONFETI (Corazones pixelados)
function createConfetti() {
    for(let i=0; i<50; i++) {
        const heart = document.createElement('div');
        heart.innerHTML = Math.random() > 0.5 ? 'わ' : '';
        heart.style.position = 'fixed';
        heart.style.left = Math.random() * 100 + 'vw';
        heart.style.top = '-10px';
        heart.style.fontSize = (Math.random() * 20 + 10) + 'px';
        heart.style.animation = `fall ${Math.random() * 3 + 2}s linear forwards`;
        document.body.appendChild(heart);
    }
    
    // CSS inyectado para la animaci贸n
    const style = document.createElement('style');
    style.innerHTML = `
        @keyframes fall {
            to { transform: translateY(110vh) rotate(360deg); }
        }
    `;
    document.head.appendChild(style);
}
</script>

</body>
</html>
